<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://shankarchari.github.io/gowrishankarin.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://shankarchari.github.io/gowrishankarin.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://shankarchari.github.io/gowrishankarin.github.io/main.cbe6761f5adb9ec38962b52f59fe61b74d7af20296267ab35a185e125109f79434987b0deb1827deedf23d9bcb7c554c77fa6052c01fa98769c7bb1939e3193c.css integrity="sha512-y+Z2H1rbnsOJYrUvWf5ht0168gKWJnqzWhheElEJ95Q0mHsN6xgn3u3yPZvLfFVMd/pgUsAfqYdpx7sZOeMZPA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Understanding Post-Synaptic Depression through Tsodyks-Markram Model by Solving Ordinary Differential Equation - Gowri Shankar</title><meta name=description content="Understanding the building blocks of the brain and its responsive nature is always a frontier for conquest and fascinating area of research. In this post, let us explore the temporal data acquired from the somatic recordings that explains short term synaptic plasticity strongly affects the neural dynamics of neocortical networks."><link rel=canonical href=https://shankarchari.github.io/gowrishankarin.github.io/blog/understanding-post-synaptic-depression-through-tsodyks-markram-model-by-solving-ordinary-differential-equation/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shankarchari.github.io/gowrishankarin.github.io/profile.png"><meta name=twitter:title content="Understanding Post-Synaptic Depression through Tsodyks-Markram Model by Solving Ordinary Differential Equation"><meta name=twitter:description content="Understanding the building blocks of the brain and its responsive nature is always a frontier for conquest and fascinating area of research. In this post, let us explore the temporal data acquired from the somatic recordings that explains short term synaptic plasticity strongly affects the neural dynamics of neocortical networks."><meta name=twitter:site content="@gowrishankarin"><meta name=twitter:creator content="@gowrishankarin"><meta property="og:title" content="Understanding Post-Synaptic Depression through Tsodyks-Markram Model by Solving Ordinary Differential Equation"><meta property="og:description" content="Understanding the building blocks of the brain and its responsive nature is always a frontier for conquest and fascinating area of research. In this post, let us explore the temporal data acquired from the somatic recordings that explains short term synaptic plasticity strongly affects the neural dynamics of neocortical networks."><meta property="og:type" content="article"><meta property="og:url" content="https://shankarchari.github.io/gowrishankarin.github.io/blog/understanding-post-synaptic-depression-through-tsodyks-markram-model-by-solving-ordinary-differential-equation/"><meta property="og:image" content="https://shankarchari.github.io/gowrishankarin.github.io/profile.png"><meta property="article:published_time" content="2021-03-12T09:19:42+01:00"><meta property="article:modified_time" content="2021-03-12T09:19:42+01:00"><meta property="og:site_name" content="Gowri Shankar"><meta property="article:publisher" content="https://www.facebook.com/verlinde.henk"><meta property="article:author" content="https://www.facebook.com/verlinde.henk"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shankarchari.github.io\/gowrishankarin.github.io\/blog\/understanding-post-synaptic-depression-through-tsodyks-markram-model-by-solving-ordinary-differential-equation\/"},"headline":"Understanding Post-Synaptic Depression through Tsodyks-Markram Model by Solving Ordinary Differential Equation","image":[],"datePublished":"2021-03-12T09:19:42CET","dateModified":"2021-03-12T09:19:42CET","author":{"@type":"Organization","name":"Gowri Shankar"},"publisher":{"@type":"Organization","name":"Gowri Shankar","logo":{"@type":"ImageObject","url":"https:\/\/shankarchari.github.io\/logo-doks.png"}},"description":"Understanding the building blocks of the brain and its responsive nature is always a frontier for conquest and fascinating area of research. In this post, let us explore the temporal data acquired from the somatic recordings that explains short term synaptic plasticity strongly affects the neural dynamics of neocortical networks."}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/shankarchari.github.io\/gowrishankarin.github.io\/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https:\/\/shankarchari.github.io\/gowrishankarin.github.io\/blog\/"},{"@type":"ListItem","position":3,"name":"Understanding Post Synaptic Depression Through Tsodyks Markram Model by Solving Ordinary Differential Equation","item":"https:\/\/shankarchari.github.io\/gowrishankarin.github.io\/blog\/understanding-post-synaptic-depression-through-tsodyks-markram-model-by-solving-ordinary-differential-equation\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://shankarchari.github.io/gowrishankarin.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://shankarchari.github.io/gowrishankarin.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://shankarchari.github.io/gowrishankarin.github.io/favicon-16x16.png><link rel=manifest href=https://shankarchari.github.io/gowrishankarin.github.io/site.webmanifest><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
</script></head><body class="blog single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=https://shankarchari.github.io/gowrishankarin.github.io/>Gowri Shankar</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/gowrishankarin><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=https://shankarchari.github.io/gowrishankarin.github.io/docs/prologue/education/>Accolades</a></li><li class="nav-item active"><a class=nav-link href=https://shankarchari.github.io/gowrishankarin.github.io/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=https://shankarchari.github.io/gowrishankarin.github.io/reads/>Bookshelf</a></li><li class=nav-item><a class=nav-link href=https://shankarchari.github.io/gowrishankarin.github.io/contributors/gowri-shankar>Contact</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row justify-content-left"><div class=col-12><article><div class=blog-header><h1>Understanding Post-Synaptic Depression through Tsodyks-Markram Model by Solving Ordinary Differential Equation</h1><p><small>Posted March 12, 2021 by <a class="stretched-link position-relative" href=https://shankarchari.github.io/contributors/gowri-shankar/>Gowri Shankar</a>&nbsp;&dash;&nbsp;<strong>9&nbsp;min read</strong></small><p></div><p class=lead>Understanding the building blocks of the brain and its responsive nature is always a frontier for conquest and fascinating area of research. In this post, let us explore the temporal data acquired from the somatic recordings that explains short term synaptic plasticity strongly affects the neural dynamics of neocortical networks.</p><p>This is an attempt to understand and run a commentary of TM Model proposed by Misha V.Tsodyks and Henry Markram in their 1997 paper named <a href=https://www.pnas.org/content/94/2/719>The neural code between neocortical pyramidal neurons depends on neurotransmitter release probability</a> that demonstrates the complex computational tasks performed by the synapses in the neocortical pyramidal neuron pairs for a given stimuli.</p><h3 id=objective>Objective</h3><p>Objectives that we want to achieve by the end of this write</p><ul><li>Structure and functions of Synapse</li><li>Neurotransmitters and few examples</li><li>Understand Trodyks - Markram Model and its various states</li><li>Deep dive into Kinatic Equations of TM Model</li><li>Programmatically Construct the TM Model</li><li>Visualizing the post synaptic recordings</li><li>Construct the Ordinary Differential Equation that optimizes the key parameters</li><li>Conduct residual analysis on the in vitro recordings and model predictions</li></ul><h3 id=introduction>Introduction</h3><p>Being an electrical engineer, I see a synapse and their attributes are similar to a capacitors of electical subsystems. I confess, often I confuse them with resistors as well - my bad. A simple reason could be the similarity in symbolic representation of a capacitor and structure of a synapes and synaptic cleft. Also, function of synapse and a capacitor identified quite similar. My gut feel, synapses could be the inspiration for the invention of capacitance for the power transmission system by in large. Need to mention, though they are vastly different in their form factor but nothing beyond interms of their functions.</p><p><img src=./synapse.png alt=Synapse title="Overview of Backpropagation">
Image Credit: <a href=https://www.britannica.com/science/synapse>Encyclopedia Brittanica</a></p><p>What Synapses do, they release neurotransmitters using ionic channels via vesicles during presynaptic phase that carry the $Ca^+$ ions to the synapse of the next neuron via synaptic cleft through receptors called post synaptic phase. Similar to the electrical transmission across the grid. To be honest, it is not very difficult for an electrical engineer to comprehend and appreciate the grand design through neurons, ionic channels, impulses and potential differences by an over simplified power transmission system.</p><p>It has been estimated a typical human brain has 100 - 400 trillion synapses carrying messages round the clock. I am sure our telecommunication networks must be ashamed of their capacity and bandwidth that they often try to brag about.</p><p>We really do not know how many neurotransmitters are there in the sytsem but a count of 200 could be a good approximation. Following are the few that are commonly known,</p><ul><li>Monamines: Dopamine, Histamine, Serotonin, Epinephrine (adrenaline) etc</li><li>Peptides: Oxytocin, Amphetamine (Is it restoring your memories of breaking bad, you are right there)</li><li>Amino Acids: Glutamate, Glycine</li></ul><iframe id=mntl-sc-block-iframe__uri_1-0 width=800 height=600 class="comp biodigital mntl-sc-block-iframe__uri mntl-block lazyloaded" data-src="https://human.biodigital.com/widgets/verywell/?be=30PX&ui-info=false&ui-fullscreen=false&ui-zoom=true&ui-share=false&initial.button=true&uaid=45R0N" frameborder=0 allowfullscreen title=Synapses src="https://human.biodigital.com/widgets/verywell/?be=30PX&ui-info=false&ui-fullscreen=false&ui-zoom=true&ui-share=false&initial.button=true&uaid=45R0N"></iframe><h2 id=short-term-synaptic-plasticity-stsp>Short-term Synaptic Plasticity (STSP)</h2><p>STSP is the short term variations of the synaptic efficacy directly affect the timing and integration of presynaptic inputs to postsynaptic neurons. This is an activity regulatory mechanism that controls the cortical responses to strong stimuli called as <code>Synaptic Depression</code>. This biophysical activity works as nonlinear adaptive filters in the visual system for low contrast stimulis and short latency for high contrast stimuli. This triggers some sort of a thought process how contrastive learning of visual representations are quite effective, demonstrated in the famous <a href=https://arxiv.org/abs/2002.05709>SimCLR paper by Simon Kornblith, Geoffrey Hinton et al.</a></p><p>The stochastic nature of the neurotransmitter release is a function of various attributes of the synaptic transmission determined experimentally. Understanding the equations provides better insights of the synaptic function of pyramidal neurons taken from the somato sensory cortical area of the wistor rats.</p><h3 id=somatic-recording-dataset>Somatic Recording Dataset</h3><p>Tsodyks-Markram model fits the parameters of a given in vitro somatic recording data. The data provided by Rodrigo Perin(EPFL) shows L5TTPC-L5TTPC depression connection trace. This recording is done using a complex process by cutting the sagittal slices of the neocortex of the animal of interest. The details of the experimental setup is provided in the source literature in detail which is beyond the scope of this article.</p><p>Final recordings are provided in pickle format for simulations and experiments. Let us load the data and explore.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>

<span class=kn>import</span> <span class=nn>seaborn</span> <span class=kn>as</span> <span class=nn>sns</span>
<span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=kn>as</span> <span class=nn>plt</span>
<span class=kn>import</span> <span class=nn>pickle</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=kn>as</span> <span class=nn>np</span>

<span class=c1># Plotting context and style</span>
<span class=n>sns</span><span class=o>.</span><span class=n>set_context</span><span class=p>(</span><span class=s1>&#39;talk&#39;</span><span class=p>)</span>
<span class=n>sns</span><span class=o>.</span><span class=n>set_style</span><span class=p>(</span><span class=s1>&#39;whitegrid&#39;</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>somatic_recording</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;trace.pkl&#39;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>),</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;iso-8859-1&#39;</span><span class=p>)</span>
<span class=n>somatic_recording</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span>
</code></pre></div><pre><code>dict_keys(['t', 'tstim', 'v'])
</code></pre><p>We have 3 parameters,</p><ul><li>Time of observation (t)</li><li>Observed Potential (v)</li><li>Time at which a stimuli was given to the neuron pair/cluster (t)</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>time</span> <span class=o>=</span> <span class=n>somatic_recording</span><span class=p>[</span><span class=s1>&#39;t&#39;</span><span class=p>]</span>
<span class=n>voltage</span> <span class=o>=</span> <span class=n>somatic_recording</span><span class=p>[</span><span class=s1>&#39;v&#39;</span><span class=p>]</span>
<span class=n>time_of_stimuli</span> <span class=o>=</span> <span class=n>somatic_recording</span><span class=p>[</span><span class=s1>&#39;tstim&#39;</span><span class=p>]</span>

<span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s1>&#39;Explore the data: {len(time)}, {len(voltage)}, {len(time_of_stimuli)}&#39;</span><span class=p>)</span>
</code></pre></div><pre><code>Explore the data: 13000, 13000, 9
</code></pre><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
<span class=c1>#fig, ax = plt.subplots()</span>
<span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>somatic_recording</span><span class=p>[</span><span class=s1>&#39;t&#39;</span><span class=p>],</span> <span class=n>somatic_recording</span><span class=p>[</span><span class=s1>&#39;v&#39;</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;in vitro somatic recording&#34;</span><span class=p>)</span>
<span class=c1>#plt.scatter(np.searchsorted(time, time_of_stimuli), time_of_stimuli)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Time (secs)&#39;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Soma Voltage (V)&#39;</span><span class=p>)</span>
</code></pre></div><pre><code>Text(0, 0.5, 'Soma Voltage (V)')
</code></pre><p><img src=output_10_1.png alt=png></p><p><strong>Observation</strong></p><ul><li>We had 9 occassions at which a stimulus was given and 9 peaks are observed</li><li>Last peak indicates the recovery state</li></ul><h3 id=significant-parameters>Significant Parameters</h3><p>Our goal for this notebook is to understand TM Model and not fit the parameters by training. Hence, the model is pre-fit and the optimum parameters are provided as constants.</p><p><strong>From Data</strong></p><ul><li>TIME_DELTA, It is the time interval at which the voltage/potential is measured</li><li>N_SAMPLES, Total number of observations made over a period of time</li><li>RESTING_POTENTIAL, Its the mean of resting voltage from $t_0$ to $t_{stimuli_1}$, calculated from the somatic recording dataset</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>TIME_DELTA</span> <span class=o>=</span> <span class=n>time</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>time</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=n>N_SAMPLES</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>voltage</span><span class=p>)</span>
<span class=n>voltage_baseline</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=n>time_of_stimuli</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<span class=n>RESTING_POTENTIAL</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>voltage</span><span class=p>[:</span><span class=n>voltage_baseline</span><span class=p>])</span>
</code></pre></div><p><strong>From Fitted Model</strong></p><ul><li>T_REC: Recovery time constant in ms</li><li>T_FAC: Facilitation time constant in ms</li><li>ASE: Absolute Synaptic Efficacy</li><li>USE: Utilization of synaptic efficacy. Hs to be in the interval of [0, 1]</li><li>R_INPUT: Input resistance (MOhm)</li><li>T_MEM: Membrane time constant (ms)</li><li>T_INAC: Inactivation time constant</li><li>LATENCY: PSP Latency</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=c1># Optimum values from Tsodyks-Markram Model </span>
<span class=n>T_REC</span> <span class=o>=</span> <span class=mf>415.56</span>
<span class=n>T_FAC</span> <span class=o>=</span> <span class=mf>163.12</span>
<span class=n>ASE</span> <span class=o>=</span> <span class=mf>1877.15</span>
<span class=n>USE</span> <span class=o>=</span> <span class=mf>0.52</span>
<span class=n>R_INPUT</span> <span class=o>=</span> <span class=mf>51.82</span>
<span class=n>T_MEM</span> <span class=o>=</span> <span class=mf>32.79</span>
<span class=n>T_INAC</span> <span class=o>=</span> <span class=mf>1.27</span>
<span class=n>LATENCY</span> <span class=o>=</span> <span class=mf>4.21</span>
</code></pre></div><h2 id=the-model>The Model</h2><p>Let us construct the building blocks for the ordinary differential equations to complete the TM Model</p><ul><li>Synaptic connection is characterized by the absolute amount of resurources it has</li><li>The resources can be classified into 3 states and their Kinetic Equations are portrayed in the subsequent sections<ul><li>Recovered State (R)</li><li>Effective State (E)</li><li>Inactive State (R)</li></ul></li></ul><h3 id=inactive-state-i>Inactive State (I)</h3><p>Inactive state is the period when there is no recovery or stimuli is given to the soma.<br>$$\Large I = 1 - R - E $$<br>$$i.e$$<br>$$I = 1 - R(t) - E(t)$$</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>calc_inactive_state</span><span class=p>(</span><span class=n>R_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>):</span>
    <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>R_prev</span> <span class=o>-</span> <span class=n>E_prev</span>
</code></pre></div><h3 id=recovered-state-r>Recovered State (R)</h3><ul><li>Each presynaptic AP activates a certain fraction of resources available: Recovered State<ul><li>Results in quickly inactivates with a time constant of about 1 sec<br>$$\Large\frac{dR}{dt} = \frac{I}{\tau_{rec}} - U_{SE} \cdot R \cdot \delta(t - t_{AP})$$<br>$$i.e.$$
$$\frac{dR(t)}{dt} = \frac{1 - R(t) - E(t)}{D} - U(t)R(t)\delta(t - t_{spike})$$</li></ul></li><li>$\tau_{rec}$ is the time constant of recovery. This is explained below</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>activation_fraction</span><span class=p>(</span><span class=n>USE_prev</span><span class=p>,</span> <span class=n>R_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>USE_prev</span> <span class=o>*</span> <span class=n>R_prev</span> <span class=o>*</span> <span class=n>AP_prev</span>

<span class=k>def</span> <span class=nf>calc_recovered_state</span><span class=p>(</span><span class=n>R_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>):</span>
    <span class=n>recovery</span> <span class=o>=</span> <span class=n>TIME_DELTA</span> <span class=o>*</span> <span class=n>calc_inactive_state</span><span class=p>(</span><span class=n>R_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>)</span> <span class=o>*</span>  <span class=mf>1e3</span> <span class=o>/</span> <span class=n>T_REC</span>
    <span class=k>return</span> <span class=n>recovery</span> <span class=o>-</span> <span class=n>activation_fraction</span><span class=p>(</span><span class=n>USE_prev</span><span class=p>,</span> <span class=n>R_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>)</span>
</code></pre></div><h3 id=effective-state-e>Effective State (E)</h3><ul><li>When all the resources are activated by a presynaptice action potential AP: Effective State<ul><li>Triggers a maximum possible response called Absolute Synaptic Efficacy $A_{SE}$<br>$$\Large\frac{dE}{dt} = - \frac{E}{\tau_{inac}} + U_{SE} \cdot R \cdot \delta(t - t_{AP})$$<br>$$i.e.$$<br>$$\frac{dE(t)}{dt} = - \frac{E}{\tau_{inac}} + U(t)R(t) \delta(t - t_{spike})$$</li></ul></li><li>$\tau_{inac}$ is the time constant for inactivation</li><li>$t_{spike}$ is the time of stimuli</li><li>$U_{SE}$ is the fraction of $A_{SE}$ utilized. i.e Utilization of synaptic efficacy parameter</li><li>$U_{SE}$ is the synaptic resources available in the recovered state</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>calc_effective_state</span><span class=p>(</span><span class=n>E_prev</span><span class=p>,</span> <span class=n>R_prev</span><span class=p>,</span> <span class=n>USE_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>):</span>
    <span class=n>effect</span> <span class=o>=</span> <span class=o>-</span><span class=n>TIME_DELTA</span> <span class=o>*</span> <span class=n>E_prev</span> <span class=o>*</span> <span class=mf>1e3</span> <span class=o>/</span> <span class=n>T_INAC</span> 
    <span class=k>return</span> <span class=n>effect</span> <span class=o>+</span> <span class=n>activation_fraction</span><span class=p>(</span><span class=n>USE_prev</span><span class=p>,</span> <span class=n>R_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>)</span>
</code></pre></div><h3 id=synaptic-efficacy-utilization-factor>Synaptic Efficacy Utilization Factor</h3><ul><li>The net post-synaptic somatic current is proportional to the fraction of resources in the effective state, E</li><li>Synaptic input from large populations of neurons are expected to average out the fluctuations and failures</li><li>$U_{SE}$ determines the dynamic behvior of synaptic tranmission, in particular rate of depression</li></ul><p>$$\Large\frac{dU(t)}{dt} = \frac{U_{SE} - U(t)}{\tau_{fac}} + U_{SE}(1 - U(t))\delta(t - t_{spike})$$<br>Where $\tau_{fac}$ is the facilitation time constant. Facilitation time contant is the constant from the pre-synaptic phase of the Synaptic Plasticity process</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>calc_efficacy_utilization_factor</span><span class=p>(</span><span class=n>USE_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>):</span>
    <span class=k>return</span> <span class=o>-</span><span class=n>TIME_DELTA</span> <span class=o>*</span> <span class=p>(</span><span class=n>USE_prev</span> <span class=o>-</span> <span class=n>USE</span><span class=p>)</span> <span class=o>*</span> <span class=mf>1e3</span> <span class=o>/</span> <span class=n>T_FAC</span> <span class=o>+</span> <span class=n>USE</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>USE_prev</span><span class=p>)</span> <span class=o>*</span> <span class=n>AP_prev</span>
</code></pre></div><h3 id=excitatory-post-synaptic-potential>Excitatory Post Synaptic Potential</h3><p>$$\tau_{mem}\frac{dV(t)}{dt} = -V + R_{inp}I_{syn}(t)$$
$$\frac{dV(t)}{dt} = \frac{-V + R_{inp}I_{syn}(t)}{\tau_{mem}}$$
where $I_{syn}(t)=A_{SE}E(t)$
$$\Large\frac{dV(t)}{dt} = \frac{-V + R_{inp}A_{SE}E(t)}{\tau_{mem}}$$</p><p>Where,</p><ul><li>ASE: Absolute Synaptic Efficacy</li><li>Rinput: Input resistance (MOhm)</li><li>Tmem: Membrane time constant (ms)</li></ul><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>calc_post_synaptic_voltage</span><span class=p>(</span><span class=n>V_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>TIME_DELTA</span> <span class=o>*</span> <span class=p>(</span><span class=n>R_INPUT</span> <span class=o>*</span> <span class=n>ASE</span> <span class=o>/</span> <span class=mi>10</span> <span class=o>**</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>E_prev</span> <span class=o>-</span> <span class=n>V_prev</span><span class=p>)</span> <span class=o>*</span> <span class=mf>1e3</span> <span class=o>/</span> <span class=n>T_MEM</span>
</code></pre></div><h3 id=tm-model-ordinary-differential-equation>TM Model Ordinary Differential Equation</h3><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>AP</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Action Potential</span>
<span class=n>I</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Inactive State</span>
<span class=n>R</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Recovery State</span>
<span class=n>E</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Effective State</span>
<span class=n>U</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Synaptice Efficacy Utilization Factor</span>
<span class=n>P</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N_SAMPLES</span><span class=p>)</span> <span class=c1># Excitatory Post-synaptic Potential</span>

<span class=c1># Set stimuli in AP vector</span>
<span class=n>psp_offset</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mf>1e-3</span> <span class=o>*</span> <span class=n>LATENCY</span> <span class=o>/</span> <span class=n>TIME_DELTA</span><span class=p>))</span>
<span class=c1># At what index the stimuli was given from the data</span>
<span class=n>time_of_stimuli_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=n>time_of_stimuli</span><span class=p>)</span>
<span class=n>AP</span><span class=p>[</span><span class=n>time_of_stimuli_idx</span> <span class=o>+</span> <span class=n>psp_offset</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>

<span class=n>R</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
<span class=n>E</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<span class=n>P</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<span class=n>U</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>USE</span>

<span class=c1># Integrate TM model ODE</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>N_SAMPLES</span><span class=p>):</span>
    <span class=n>R_prev</span> <span class=o>=</span> <span class=n>R</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>E_prev</span> <span class=o>=</span> <span class=n>E</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>USE_prev</span> <span class=o>=</span> <span class=n>U</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>AP_prev</span> <span class=o>=</span> <span class=n>AP</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>P_prev</span> <span class=o>=</span> <span class=n>P</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

    <span class=n>R</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>R_prev</span> <span class=o>+</span> <span class=n>calc_recovered_state</span><span class=p>(</span><span class=n>R_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>)</span>
    <span class=n>E</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>E_prev</span> <span class=o>+</span> <span class=n>calc_effective_state</span><span class=p>(</span><span class=n>E_prev</span><span class=p>,</span> <span class=n>R_prev</span><span class=p>,</span> <span class=n>USE_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>)</span>
    <span class=n>U</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>USE_prev</span> <span class=o>+</span> <span class=n>calc_efficacy_utilization_factor</span><span class=p>(</span><span class=n>USE_prev</span><span class=p>,</span> <span class=n>AP_prev</span><span class=p>)</span>
    <span class=n>P</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>P_prev</span> <span class=o>+</span> <span class=n>calc_post_synaptic_voltage</span><span class=p>(</span><span class=n>P_prev</span><span class=p>,</span> <span class=n>E_prev</span><span class=p>)</span>

<span class=n>P</span> <span class=o>=</span> <span class=n>P</span> <span class=o>+</span> <span class=n>RESTING_POTENTIAL</span>
<span class=n>E</span> <span class=o>=</span> <span class=n>E</span> <span class=o>*</span> <span class=n>ASE</span> <span class=o>/</span> <span class=mi>10</span><span class=o>**</span><span class=mi>12</span>
<span class=n>I</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>R</span> <span class=o>-</span> <span class=n>E</span>
<span class=n>tm_statevar</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;recovered&#39;</span><span class=p>:</span> <span class=n>R</span><span class=p>,</span>
    <span class=s1>&#39;effective&#39;</span><span class=p>:</span> <span class=n>E</span><span class=p>,</span>
    <span class=s1>&#39;used&#39;</span><span class=p>:</span> <span class=n>U</span><span class=p>,</span>
    <span class=s1>&#39;inactive&#39;</span><span class=p>:</span> <span class=n>I</span>
<span class=p>}</span>
</code></pre></div><h3 id=model-vs-in-vitro-recordings>Model vs In Vitro Recordings</h3><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
<span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=n>voltage</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;in vitro&#39;</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=n>P</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;model&#39;</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>time_of_stimuli</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>tile</span><span class=p>(</span><span class=o>-</span><span class=mf>0.0720</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>time_of_stimuli</span><span class=p>)),</span> <span class=n>c</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time (s)&#39;</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Soma Voltage (V)&#39;</span><span class=p>)</span>
</code></pre></div><pre><code>Text(0, 0.5, 'soma voltage (V)')
</code></pre><p><img src=output_30_1.png alt=png></p><h3 id=residual-analysis>Residual Analysis</h3><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=c1># Compute time windows where to compare model and data</span>
<span class=n>offset</span> <span class=o>=</span> <span class=mf>0.005</span>
<span class=n>window</span> <span class=o>=</span> <span class=mf>0.04</span>
<span class=n>window_samples</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=n>window</span><span class=o>/</span><span class=n>TIME_DELTA</span><span class=p>))</span>
<span class=n>psp_start</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=n>time_of_stimuli</span> <span class=o>+</span> <span class=n>offset</span><span class=p>)</span>
<span class=n>psp_stop</span> <span class=o>=</span> <span class=n>psp_start</span> <span class=o>+</span> <span class=n>window_samples</span>
<span class=c1># Extend the last window sample</span>
<span class=n>psp_stop</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>window_samples</span> 

</code></pre></div><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>errors</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>voltage</span><span class=p>[</span><span class=n>t0</span><span class=p>:</span><span class=n>t1</span><span class=p>]</span> <span class=o>-</span> <span class=n>P</span><span class=p>[</span><span class=n>t0</span><span class=p>:</span><span class=n>t1</span><span class=p>])</span>
                  <span class=k>for</span> <span class=n>t0</span><span class=p>,</span> <span class=n>t1</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>psp_start</span><span class=p>,</span> <span class=n>psp_stop</span><span class=p>)]</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>errors</span>
</code></pre></div><pre><code>[0.0007234243428066414,
 0.0004888662691707077,
 0.0010873177825812125,
 0.0008418253850070241,
 0.0006462322236686935,
 0.0007670816927837292,
 0.0008081681717810904,
 0.000832403020059831,
 0.0014329186972264394]
</code></pre><h2 id=inference>Inference</h2><p>Have we accomplished the following objectives that we have set&mldr;</p><ul><li>Structure and functions of Synapse - Yes</li><li>Neurotransmitters and few examples - Yes</li><li>Understand Trodyks - Markram Model and its various states - Yes</li><li>Deep dive into Kinetic Equations of TM Model - Yes</li><li>Programmatically Construct the TM Model - Yes</li><li>Visualizing the post synaptic recordings - Yes</li><li>Construct the Ordinary Differential Equation that optimizes the key parameters - Yes</li><li>Conduct residual analysis on the in vitro recordings and model predictions - Yes</li></ul><h3 id=references>References</h3><ul><li><a href=https://www.pnas.org/content/pnas/94/2/719.full.pdf>The neural code between neocortical pyramidal neurons depends on neurotransmitter release probability</a></li><li><a href=https://arxiv.org/pdf/1309.7966.pdf>https://arxiv.org/pdf/1309.7966.pdf</a></li><li><a href=https://www.verywellhealth.com/synapse-anatomy-2795867>Synapses in the Nervous System - Where Nerve Impulses Are Passed from Neuron to Neuron</a></li><li><a href=https://github.com/BlueBrain/BluePyOpt/blob/master/examples/tsodyksmarkramstp/tsodyksmarkramstp.ipynb>Tsodyks-Markram model of short-term synaptic plasticity</a></li></ul><pre><code>
@ARTICLE{bluepyopt,
AUTHOR={Van Geit, Werner  and  Gevaert, Michael  and  Chindemi, Giuseppe  and  Rössert, Christian  and  Courcol, Jean-Denis  and  Muller, Eilif Benjamin  and  Schürmann, Felix  and  Segev, Idan  and  Markram, Henry},
TITLE={BluePyOpt: Leveraging open source software and cloud infrastructure to optimise model parameters in neuroscience},
JOURNAL={Frontiers in Neuroinformatics},
VOLUME={10},
YEAR={2016},
NUMBER={17},
URL={http://www.frontiersin.org/neuroinformatics/10.3389/fninf.2016.00017/abstract},
DOI={10.3389/fninf.2016.00017},
ISSN={1662-5196}
}
</code></pre><div class=highlight><pre class=chroma><code class=language-python data-lang=python>
</code></pre></div></article></div><nav class="docs-toc d-none d-xl-block col-xl-4" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#objective>Objective</a></li><li><a href=#introduction>Introduction</a></li></ul></li><li><a href=#short-term-synaptic-plasticity-stsp>Short-term Synaptic Plasticity (STSP)</a><ul><li><a href=#somatic-recording-dataset>Somatic Recording Dataset</a></li><li><a href=#significant-parameters>Significant Parameters</a></li></ul></li><li><a href=#the-model>The Model</a><ul><li><a href=#inactive-state-i>Inactive State (I)</a></li><li><a href=#recovered-state-r>Recovered State (R)</a></li><li><a href=#effective-state-e>Effective State (E)</a></li><li><a href=#synaptic-efficacy-utilization-factor>Synaptic Efficacy Utilization Factor</a></li><li><a href=#excitatory-post-synaptic-potential>Excitatory Post Synaptic Potential</a></li><li><a href=#tm-model-ordinary-differential-equation>TM Model Ordinary Differential Equation</a></li><li><a href=#model-vs-in-vitro-recordings>Model vs In Vitro Recordings</a></li><li><a href=#residual-analysis>Residual Analysis</a></li></ul></li><li><a href=#inference>Inference</a><ul><li><a href=#references>References</a></li></ul></li></ul></nav></div></nav></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Copyright 2021 <a href=https://www.gowrishankar.info/>GowriShankar.info</a> All rights reserved</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline></ul></div></div></div></footer><script src=https://shankarchari.github.io/gowrishankarin.github.io/main.f6b484f556ad1f3bcf6061082139a2f21fa759f13930c39a25fe4a9f78f35e64122c2d86dffd56e67b292dabbda4095d8077194f196e0e348441c106a9f3d40e.js integrity="sha512-9rSE9VatHzvPYGEIITmi8h+nWfE5MMOaJf5Kn3jzXmQSLC2G3/1W5nspLau9pAldgHcZTxluDjSEQcEGqfPUDg==" crossorigin=anonymous defer></script><script src=https://shankarchari.github.io/gowrishankarin.github.io/index.min.e8052e2ce1e90dd5f40dd0d369a12cad1ce7a9a56906d0ad60aa3501d7e82108ec4ecdf859f27fe831d0a878df325860e1813692f8741b516d3704d939317965.js integrity="sha512-6AUuLOHpDdX0DdDTaaEsrRznqaVpBtCtYKo1AdfoIQjsTs34WfJ/6DHQqHjfMlhg4YE2kvh0G1FtNwTZOTF5ZQ==" crossorigin=anonymous defer></script></body></html>